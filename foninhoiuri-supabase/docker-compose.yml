version: '3.8'

services:
  auth:
    image: supabase/gotrue:v2.176.1
    restart: unless-stopped
    ports:
      - 8001:8000
    environment:
      DB_URL: postgresql://default:default@postgres:5432/supabase
      JWT_SECRET: changeme-supersecretjwtwith32chars! # ğŸ” ALTERE: use uma string aleatÃ³ria com no mÃ­nimo 32 caracteres
      SITE_URL: http://${DEVICE_DOMAIN_NAME}:3000/auth/v1 # ğŸŒ ALTERE se o domÃ­nio real do app for diferente
      DISABLE_SIGNUP: "false" # ğŸš« VocÃª pode definir como "true" para desativar registros pÃºblicos

  storage:
    image: supabase/storage-api:latest
    restart: unless-stopped
    ports:
      - 8002:5000
    environment:
      DB_URL: postgresql://default:default@postgres:5432/supabase
      JWT_SECRET: changeme-supersecretjwtwith32chars! # ğŸ” MANTENHA igual ao JWT usado nos outros serviÃ§os
      STORAGE_BACKEND: s3 # â˜ï¸ ALTERE para "file" se nÃ£o for usar S3
      GLOBAL_S3_BUCKET: my-supabase-bucket # ğŸ“¦ ALTERE: nome do bucket na AWS
      STORAGE_S3_REGION: us-east-1 # ğŸŒ ALTERE: regiÃ£o onde seu bucket S3 estÃ¡ hospedado
      AWS_ACCESS_KEY_ID: myawsaccesskeyid # ğŸ”‘ ALTERE: sua chave de acesso da AWS
      AWS_SECRET_ACCESS_KEY: myawssecretaccesskey # ğŸ” ALTERE: seu segredo da AWS
    volumes:
      - ${APP_DATA_DIR}/data/storage:/var/log/supabase/storage

  rest:
    image: postgrest/postgrest:latest
    restart: unless-stopped
    ports:
      - 8003:3000
    environment:
      PGRST_DB_URI: postgresql://default:default@postgres:5432/supabase
      PGRST_JWT_SECRET: changeme-supersecretjwtwith32chars! # ğŸ” MANTENHA igual ao dos outros serviÃ§os
      PGRST_DB_SCHEMA: public,storage,auth,extensions # ğŸ“‚ ALTERE se usar schemas personalizados
      PGRST_DB_ANON_ROLE: anon # ğŸ‘¤ ALTERE se quiser outro role default para acesso anÃ´nimo

  realtime:
    image: supabase/realtime:latest
    restart: unless-stopped
    ports:
      - 8004:4000
    environment:
      DB_URL: postgresql://default:default@postgres:5432/supabase
      JWT_SECRET: changeme-supersecretjwtwith32chars! # ğŸ” MESMA JWT para autenticaÃ§Ã£o
      REDIS_URL: redis://redis:6379 # âš ï¸ Confirme o ID/nome do seu Redis no Umbrel

  studio:
    image: supabase/studio:latest
    restart: unless-stopped
    ports:
      - 8000:3000
    environment:
      SUPABASE_URL: http://${DEVICE_DOMAIN_NAME}:3000 # ğŸŒ ALTERE se o domÃ­nio mudar
      SUPABASE_ANON_KEY: anon_key_generated_from_jwt # ğŸ”‘ ALTERE: gere baseado no JWT real
      SUPABASE_SERVICE_ROLE_KEY: service_role_key_generated # ğŸ”‘ ALTERE: gere baseado no JWT real
      OPENAI_API_KEY: "" # ğŸ¤– Opcional: insira sua chave da OpenAI se usar recursos com IA
